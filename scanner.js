const Scanner=(()=>{const{BrowserMultiFormatReader,NotFoundException}=ZXingBrowser;let reader=null,running=false,videoEl=null,onCode=null,rafId=null;async function init(video,onDecoded){videoEl=video;onCode=onDecoded;reader=new BrowserMultiFormatReader()}async function start(){running=true;loop()}function stop(){running=false;if(rafId)cancelAnimationFrame(rafId)}async function loop(){if(!running)return;try{const r=await reader.decodeOnceFromVideoElement(videoEl);if(r?.text){onCode?.(r.text)}}catch(e){if(!(e instanceof NotFoundException)){console.warn('decode error',e)}}finally{rafId=requestAnimationFrame(loop)}}return{init,start,stop}})();